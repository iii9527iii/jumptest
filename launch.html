<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <title>正在開啟 App...</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script>
    const appScheme = "dnakesmartlifehongsheng://";
    const iosAppStoreURL = "https://apps.apple.com/tw/app/%E9%9B%B2%E7%AB%AF%E5%B0%8D%E8%AC%9B/id6738626135";
    const androidPlayStoreURL = "https://play.google.com/store/apps/details?id=com.dnake.smartlife.hongsheng";

    let hasLeftPage = false;

    // ✅ 當頁面被隱藏或卸載時（用戶點開了 App）
    window.addEventListener('pagehide', function () {
      hasLeftPage = true;
    });

    function getOS() {
      const ua = navigator.userAgent || navigator.vendor || window.opera;
      if (/android/i.test(ua)) return "Android";
      if (/iPad|iPhone|iPod/.test(ua) && !window.MSStream) return "iOS";
      return "unknown";
    }

    window.onload = function () {
      const os = getOS();
      window.location.href = appScheme;

      // 1.5 秒後再確認是否仍在頁面，否則就跳商店
      setTimeout(() => {
        if (!hasLeftPage) {
          if (os === "iOS") {
            window.location.href = iosAppStoreURL;
          } else if (os === "Android") {
            window.location.href = androidPlayStoreURL;
          }
        }
      }, 1500);
    };
  </script>
</head>
<body>
  <p style="text-align:center; padding: 30px; font-size: 18px;">
    正在開啟 App，請稍候...
  </p>
</body>
</html>
